from win32com.client import Dispatch, gencache # API Windows
import pythoncom
def X_Y(Object):

    VertexArray = iSelectedObject.VertexParamsArray
    Count = iSelectedObject.VertexCount
    f.write(iSelectedObject.Name + "\n")
    for Vertex in VertexArray:
        f.write(str(Vertex.GetParamVertex(x,y,z,value))[7:].rstrip(')') + ";\n")

f = open(r'C:\Users\drnks\OneDrive\Desktop\Coords.txt', 'w', encoding='utf-8')

# API5
kompas6_api5_module = gencache.EnsureModule("{0422828C-F174-495E-AC5D-D31014DBBE87}", 0, 1, 0)
kompas_object = kompas6_api5_module.KompasObject(Dispatch("Kompas.Application.5")._oleobj_.QueryInterface(kompas6_api5_module.KompasObject.CLSID, pythoncom.IID_IDispatch))
iDocument3D = kompas_object.ActiveDocument3D()

x,y,z,value = 0.0, 0.0, 0.0, 0.0

KompasAPI7 = gencache.EnsureModule('{69AC2981-37C0-4379-84FD-5DD2F3C0A520}', 0, 1, 0) # API7
iApplication = Dispatch('Kompas.Application.7')
iKompasDocument = iApplication.ActiveDocument

iKompasDocument3D = KompasAPI7.IKompasDocument3D(iKompasDocument)
iSelectionManager = iKompasDocument3D.SelectionManager
iSelectedObjects = iSelectionManager.SelectedObjects
if isinstance(iSelectedObjects, tuple):
    for iSelectedObject in iSelectedObjects:
        X_Y(iSelectedObject)
else:
    X_Y(iSelectedObject)